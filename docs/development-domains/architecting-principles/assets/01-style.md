# style: どのようにスタイル・技術を選定するか (WIP)

**コンセプト**: 強力なアーキテクチャスタイルと技術スタックの選定ポイントを押さえ、変更しづらい決定を慎重に行う

---

## 関連キーワード

- **Monolith First** (モノリス・ファースト - 最初は一枚岩で作る)
- **Modular Monolith** (モジュラーモノリス - 内部で分割された一枚岩)
- **Microservices** (マイクロサービス - 独立してデプロイ可能な小さなサービス群)
- **Serverless** (サーバーレス - インフラ管理を委譲する)
- **Boring Technology** (退屈な技術 - 枯れた安定技術を選ぶ)
- **Innovation Tokens** (イノベーショントークン - 新しい技術への挑戦は数回に限る)
- **IaC** (Infrastructure as Code - インフラをコードで管理する)

---

## アーキテクチャスタイル選定の心得

**_組織の規模とフェーズに合わせて、システムの分割単位（デプロイメント単位）を決める。_**

### 安易にマイクロサービスを選ばない（Monolith First）

- スタートアップや新規事業の初期段階では、**「モジュラーモノリス」**を第一選択肢とする
  - 理由: ドメインの境界線が曖昧な状態でサービスを物理分割すると、分散モノリス（密結合な分散システム）になり、開発効率が劇的に低下するため
- マイクロサービスへの移行は、「組織が拡大し、コミュニケーションコストが限界に達した時」や「独立したスケーラビリティが必須になった時」に検討する
  - コンウェイの法則（システム構造は組織構造に従う）を逆手に取り、チーム分割が必要になったタイミングでシステムを分割する

### インフラの抽象度を決める

- 運用リソースが乏しい場合は、サーバーレス（FaaS, Managed Services）や PaaS を積極的に活用する
  - 「車輪の再発明」を避け、差別化につながらないインフラ管理はクラウドベンダーに委譲する
- ただし、ベンダーロックインのリスクと、移植性（コンテナ技術など）のトレードオフを理解しておく
  - コンテナ（Docker/Kubernetes）を採用する場合、運用複雑度が高いため、専任のインフラエンジニアが必要になる可能性を考慮する

---

## 技術選定の心得

**_「新しさ」ではなく「信頼性」と「習熟度」で技術を選ぶ。_**

### 「退屈な技術」を選ぶ（Choose Boring Technology）

- 枯れた技術（Boring Technology）は、未知のバグが少なく、ドキュメントや知見が豊富であり、採用もしやすい
  - 流行の最先端技術（Hype）は、問題にぶつかった時の解決コストが高い
- 「イノベーショントークン」の概念を持ち、リスクを取りすぎないようにする
  - プロジェクトで導入する「新しい技術」は 2〜3 個まで（トークンの数）に制限する
  - ビジネスのコアとなる部分にのみトークンを使い、それ以外（DB、Web フレームワーク等）は標準的な技術を選ぶ

### コミュニティとエコシステムを確認する

- 以下の観点でライブラリやフレームワークを評価する
  - メンテナンス頻度（最終コミット日）
  - コミュニティの活発さ（GitHub Star 数、Issue の消化率）
  - 破壊的変更のポリシー

---

## インフラ構築の心得

**_手作業を排除し、再現可能なインフラを作ることをデプロイ戦略に組み込む。_**

### インフラをコード化する（IaC）

- 画面ポチポチ（GUI 操作）での環境構築を禁止し、Terraform や AWS CDK 等ですべてコード化する
  - 「誰がいつ何を変更したか」を追跡可能にし、環境（開発・検証・本番）間の差異をなくす
- インフラもアプリケーションコードと同様にレビューし、バージョン管理する

### ペットではなく家畜として扱う

- 特定のサーバーに愛着（名前）を持たず、いつでも廃棄・再作成できる状態（家畜）にする
  - サーバー内での手動設定や状態保持（Stateful）を避け、イミュータブル（不変）なインフラを目指す
