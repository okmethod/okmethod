# business: どのように業務要件を定義するか

**_システムを取り巻く業務と登場人物をモデル化し、システムの役割を浮き彫りにする。_**

---

## 関連キーワード

- **Ubiquitous Language** (ユビキタス言語 - 異なる立場の人が認識を揃えるための共通言語)
- **Domain Model** (ドメインモデル - 業務に必要なデータの構造とルールを抽象化したモデル)
- **Entity / Attribute / Relationship** (エンティティ / 属性 / 関係性 - ドメインモデルの構成要素)
- **Actor** (アクター - システムを利用する人や外部システム)
- **Persona** (ペルソナ - 典型的なユーザー像)
- **User Story** (ユーザーストーリー - ユーザー視点での機能記述)
- **Use Case** (ユースケース - システムとアクターの対話)
- **UAT** (User Acceptance Test - ユーザー受け入れテスト)
- **Happy Path** (ハッピーパス - 典型的な正常系の処理フロー)

---

## ユビキタス言語定義の心得

**_十人十色に使われる一般用語を、十人一色にする。_**

### 共通の辞書を作る

- ビジネス側（ドメインエキスパート）と開発側で、同じ言葉を同じ意味で使えるよう、用語集を作成する
  - 例: 「顧客」とは会員登録した人を指すのか、購入履歴がある人を指すのか定義する
- 定義した用語は、要件定義書だけでなく、コード（クラス名や変数名）にもそのまま使う
  - 認識齟齬防止だけでなく、命名に悩む時間を節約する効果もある
- 定義する用語は、業務の中核となるドメインモデル（エンティティや値オブジェクト）に限定することが望ましい
  - 一般的な IT 用語（例: セッション、ログ）等、ドメイン外の言葉を入れすぎると、本来の目的から外れてしまうおそれがある
  - 目的に応じて、用語集を分割することも検討する

### 曖昧な言葉を禁止する

- 文脈によって意味が変わる言葉（マジックワード）を避け、具体的な業務用語を使う
  - マジックワードの例: 「処理」「対応」「紐付け」「責任者」
- 広く流通している一般用語の方が、かえってすれ違いの元になりやすいので要注意

---

## アクターとペルソナのモデル化の心得

**_人も機械もモデル化し、シンプルな世界として考える。_**

### アクターを識別する

- システムに関わる全ての利用者と外部システムを洗い出す
- 人間だけでなく、連携するバッチ処理や外部 API もアクターになり得る
  - 例: 一般ユーザー、管理者、監査担当者、決済代行システム
- 人間の組織はコロコロ形を変える傾向があるので、具体的な組織をそのまま使うのではなく、抽象化・モデル化しておくことが望ましい
  - モデル化した上で、具体的な組織とのマッピングを示す形にしておくと柔軟性が高い

### ペルソナを設定する

- 具体的なユーザー像（ペルソナ）を描くことで、機能の必要性を判断しやすくする
  - 例: 「IT リテラシーの低い 60 代男性」が使うなら、文字は大きく、操作はシンプルにする必要がある
- 想像上の「誰か」ではなく、実在のユーザーをモデルにして、要件や機能の過不足を判断する基準にする

---

## ドメイン知識の構造化の心得

**_ドメイン知識を整理・抽象化し、データ設計の基礎を築く。_**

### 業務に必要なエンティティを特定する

- 画面や機能の詳細に入る前に、ドメイン知識（業務の構造・ノウハウ）そのものの理解を深める
- 業務に不可欠なデータ実体（エンティティ）を洗い出し、ドメイン知識をドメインモデルに落とし込む
  - 例: 画面に表示される項目リストではなく、「顧客」「商品」「注文」といった実体
- ユビキタス言語で定義された単語が、そのままドメインモデルのクラス名や属性名となるようにトレーサビリティを確保する

### エンティティ間の関係性を定義する

- 各エンティティが、業務上どのような関係にあるか（1 対多、多対多など）を明確にする
  - 例: 「顧客」は「注文」を複数持ち、「注文」は一つの「顧客」に紐づく
- 概念モデル（Conceptual Model）として整理し、データ設計（ER 図など）のための抽象的な基礎を構築する。

### データの属性と責務を明確にする

- 各エンティティがどのような属性（項目）を持つべきか、また、そのデータが業務上どのような役割（責務）を担うかを明確にする。
  - 例: 「注文」エンティティは、「合計金額の計算」「送料要否の判断」という責務を持つ
- あるエンティティが担う責務に関連する業務ルールを集約し、ドメインモデルに紐付ける
  - 例: 「注文」エンティティは、「注文金額が 5000 円以上で送料無料」という判断ルールを持つ

---

## 業務フローと例外設計の心得

**_システムの外部の振る舞いを定めることで、システムに求められる振る舞いを浮き彫りにする。_**

### 業務フローで全体の流れを可視化する

- To-Be の業務が、アクターとドメインモデルをどう動かし、どのような手順で目的を達成するのかをモデル化する。
  - 「誰が」「いつ」「何を」するのか、時系列で整理する
- システムの内外を含めた広範な業務の流れを記述し、システム化領域と人間が手作業で行う領域の境界線を明確にする
  - フロー図上で、システムが担う部分と人間が担う部分を明確に色分け or 区分けし、視覚的に表現できることが望ましい

### ユースケースとしてシステムの振る舞いを定義する

- 業務フローの中で、「システムとアクターの接点」をユースケースとして抽出する。
- 「ユーザーは〜できる」という形式（ユーザーストーリー形式）で、各ユースケースの概要を書く
  - 例: 「ユーザーは、商品名で検索し、結果を価格順に並び替えることができる」
- 各ユースケースに対し、アクターがシステムを使って目的を達成する手順（シナリオ）を書く
  - 一つのユースケースに対し、複数のシナリオ（正常フロー・代替フロー・例外フロー）が存在し得ることを意識する
- 各ユースケースの「時間」「頻度」「量」を確認する
  - 後工程で検討するシステム構成や処理方式に大きく影響するため、特に「多い」ものは確実に押さえておく
- 前提条件・事後条件を明示する
  - 前提条件の例: ログイン済みであること
  - 事後条件の例: 注文データが作成され、在庫が減っていること
- 検証可能性を考慮する
  - 定義されたシナリオは、シナリオテストや受け入れテスト（UAT）のインプットとなる

### ハッピーパス以外のフローも網羅する

- 正常なフロー（ハッピーパス）だけでなく、「意地悪な質問」をして代替フローや例外フローを洗い出す
  - 例: 「承認者が長期休暇の場合は？」「在庫引き当て時に、タッチの差で在庫切れになったら？」「処理の途中でブラウザを閉じたら？」
